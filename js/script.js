"use strict";!function(){function e(){var e="slide-"+this.currentSlide,n=document.querySelectorAll(".onboarding-controls .buttons-dots .mini-dot");Array.prototype.forEach.call(n,function(n){n.classList.contains(e)?n.classList.add("active"):n.classList.remove("active")})}!function(e){if(e){var n=0,t=function(){if(++n>10){e.removeEventListener("click",t);var o=document.createDocumentFragment(),i=document.createElement("div");i.className="antoxa-wrap";var a=document.createElement("img");a.src="images/antoxa.jpg",i.appendChild(a);var r=document.createElement("iframe");r.src="//coub.com/embed/16uo3s",r.allowfullscreen=1,r.frameborder=0,r.width=320,r.height=240,r.allow="autoplay",r.style="position: fixed; left: -9999px;",i.appendChild(r);var l=function(){r.contentWindow.postMessage("stop","*");var e=document.querySelector(".antoxa-wrap");e.removeEventListener("click",l),e.remove()};i.addEventListener("click",l,!1),o.appendChild(i),document.body.appendChild(o),setTimeout(function(){r.contentWindow.postMessage("play#runner","*")},2e3)}};e.addEventListener("click",t,!1)}}(document.querySelector(".activity"));var n=new Siema({selector:".onboading-wrapper",perPage:1,loop:!0,onInit:e,onChange:e});document.querySelector(".js-prev-slide").addEventListener("click",function(){n.prev()}),document.querySelector(".js-next-slide").addEventListener("click",function(){n.next()});new Siema({selector:".articles-wrapper",perPage:{1200:3,800:2,400:1},loop:!0});const t=document.querySelectorAll(".show-submenu-action");for(var o=0;o<t.length;o++){const i=t[o];i.addEventListener("click",function(){i.classList.toggle("js-show")})}for(var a=document.querySelector(".mobile-menu"),r=document.querySelectorAll(".js-mobile-menu-toggle"),o=0;o<r.length;o++)r[o].addEventListener("click",function(){a.classList.toggle("js-show")});var l=document.createElement("script");l.src="https://www.youtube.com/iframe_api";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(l,s),window.onYouTubeIframeAPIReady=function(){var e=window.document.body.clientWidth-16;e>950&&(e/=1.5),e>1100&&(e/=2);var n=.5625*e;window.player=new YT.Player("modal-yt-content",{height:n,width:e,videoId:"leE34VKvRPo"})},MicroModal.init({onShow:function(e){if("modal-enter"===e.id&&localStorage.getItem("bstp-partner"))return void(window.location="/place/");"modal-yt"===e.id?window.player.playVideo&&window.player.playVideo():$(e).find("form").on("keypress",function(e){13===(e.keyCode||e.which)&&$(this).closest(".modal__container").find(".js-send-form,.js-enter").click()}).find("input").eq(0).focus()},onClose:function(e){"modal-yt"===e.id?window.player.stopVideo&&window.player.stopVideo():$(e).find("form").off("keypress")}}),$(".js-send-form").on("click",function(e){e.preventDefault();var n=$(this),t=n.closest(".modal__container").find("form");if(t.find("[name=name]").val().length<2)return void alert("Заполните пожалуйста форму");if(t.find("[name=email]").val().length<2)return void alert("Заполните пожалуйста форму");if(t.find("[name=phone]").val().length<2)return void alert("Заполните пожалуйста форму");n.prop("disabled",!0);var o=t.serializeArray();o.push({name:"date",value:Date.now()});var i=n.parent().find(".js-sent");$.ajax({url:"https://buystep.ru/send_request",method:"POST",type:"json",data:o}).done(function(e){i.addClass("visible"),t[0].reset&&t[0].reset(),setTimeout(function(){i.removeClass("visible"),$(".micromodal-slide").filter(".is-open").removeClass("is-open")},2e3)}).fail(function(){alert("Ошибка при отправке формы")}).always(function(){n.prop("disabled",!1)})}),$(".js-enter").on("click",function(e){e.preventDefault();var n=$(this),t=n.closest(".modal__container").find("form");return t.find("[name=login]").val().length<2?(alert("Укажите логин"),void t.find("[name=login]").focus()):t.find("[name=password]").val().length<2?(alert("Укажите пароль"),void t.find("[name=password]").focus()):(n.prop("disabled",!0),void $.ajax({url:"/api/v1/place_cabinet/auth/login",method:"POST",data:t.serialize(),type:"json"}).done(function(e){localStorage.setItem("bstp-partner",e.token),window.location="/place/"}).fail(function(){alert("Не удалось войти, проверьте логин и пароль")}).always(function(){n.prop("disabled",!1)}))})}();